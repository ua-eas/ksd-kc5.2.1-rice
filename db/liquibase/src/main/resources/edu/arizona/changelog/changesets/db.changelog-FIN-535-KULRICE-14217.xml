<?xml version="1.0" encoding="UTF-8"?>

<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
        http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd">

    <changeSet id="FIN-535-KULRICE-14217" author="Jim Reese">
        <comment>
            Kuali KULRICE-14217 for Rice 2.5.19 upgrade to Rice 2.6.0
        </comment>
        <sql>
            CREATE TABLE KREW_ACTN_ITM_CHANGED_T
            (
            ACTN_TYP VARCHAR2(1),
            ACTN_ITM_ID VARCHAR2(40),
            PRIMARY KEY(ACTN_ITM_ID, ACTN_TYP)
            );
        </sql>
        <sql splitStatements="false">
            CREATE OR REPLACE TRIGGER actn_item_changed
            AFTER INSERT OR UPDATE OR DELETE ON KREW_ACTN_ITM_T
            FOR EACH ROW
            BEGIN
            -- Use 'I' for an INSERT, 'U' for UPDATE, and 'D' for DELETE
            IF INSERTING THEN
            INSERT INTO KREW_ACTN_ITM_CHANGED_T VALUES ('I', :NEW.ACTN_ITM_ID);
            ELSIF UPDATING THEN
            INSERT INTO KREW_ACTN_ITM_CHANGED_T VALUES ('U', :NEW.ACTN_ITM_ID);
            ELSE
            INSERT INTO KREW_ACTN_ITM_CHANGED_T VALUES ('D', :OLD.ACTN_ITM_ID);
            END IF;
            END;
        </sql>
        <rollback>
            <sql>
            </sql>
        </rollback>

    </changeSet>
</databaseChangeLog>

